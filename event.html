<!-- <!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>

<body>
    <h1>Event Database</h1>
    <div id="inputDiv">
        <input type="text" placeholder="Event name" id="name">
        <input type="email" placeholder="Email Address" id="email">
        <input type="text" placeholder="Company" id="company">
        <input type="text" placeholder="location" id="location">
        <input type="text" placeholder="description" id="description">
        <input type="date" placeholder="Date" id="date">
        <input type="text" placeholder="Host" id="host">
        <button id="submitBtn">Save</button>
    </div>
    <div id="display">
        <button id="readBtn">Read</button>
    </div>
</body>
<script type="module">
    const name = document.getElementById('name');
    const email = document.getElementById('email');
    const company = document.getElementById('company');
    const location = document.getElementById('location');
    const description = document.getElementById('description');
    const date = document.getElementById('date');
    const host = document.getElementById('host');
    // Import the functions you need from the SDKs you need
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getDatabase, ref, set, push, onValue } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";
    // TODO: Add SDKs for Firebase products that you want to use
    // https://firebase.google.com/docs/web/setup#available-libraries

    // Your web app's Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCPsaTnEv7jA_kGv0M-4YqsYkbBDh1q7GU",
        authDomain: "event-management-system-2573b.firebaseapp.com",
        databaseURL: "https://event-management-system-2573b-default-rtdb.firebaseio.com",
        projectId: "event-management-system-2573b",
        storageBucket: "event-management-system-2573b.firebasestorage.app",
        messagingSenderId: "559563898888",
        appId: "1:559563898888:web:6f3fed6417b572b1ef11bd"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    function writedb(userId) {
        set(push(ref(db, 'event-management-system/')), {
            name: name.value,
            email: email.value,
            company: company.value,
            location: location.value,
            description: description.value,
            date: date.value,
            host: host.value
        });
            name.value= "" 
            email.value= ""
            company.value= "" 
            location.value=  ""
            description.value= "" 
            date.value= ""
            host.value=  ""
    }

    const allData = [];
    function readdb(){
        const starCountRef = ref(db, "users/" )
        onValue(starCountRef, (snapshot) => {
            const data = snapshot.val();
            console.log(data);
            allData.push(data)
            console.log(allData);
            
            // updateStarCount(postElement, data)
        })
    }

    document.getElementById("readBtn").addEventListener("click", readdb);
    document.getElementById("submitBtn").addEventListener("click", writedb);
</script>

</html> -->
<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Event Management System</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            min-height: 100vh;
        }

        h1 {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        #inputDiv {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            max-width: 600px;
            margin: 0 auto 30px;
        }

        #inputDiv input {
            width: 100%;
            padding: 12px;
            margin-bottom: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 14px;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 14px;
            font-weight: bold;
            transition: all 0.3s;
        }

        #submitBtn {
            width: 100%;
            background: #667eea;
            color: white;
        }

        #submitBtn:hover {
            background: #5568d3;
        }

        #display {
            max-width: 900px;
            margin: 0 auto;
        }

        #eventsContainer {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .event-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            transition: transform 0.3s;
        }

        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .event-card h3 {
            color: #667eea;
            margin-bottom: 10px;
        }

        .event-card p {
            margin: 5px 0;
            color: #555;
            font-size: 14px;
        }

        .event-card strong {
            color: #333;
        }

        .card-buttons {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }

        .edit-btn {
            background: #48bb78;
            color: white;
            flex: 1;
        }

        .edit-btn:hover {
            background: #38a169;
        }

        .delete-btn {
            background: #f56565;
            color: white;
            flex: 1;
        }

        .delete-btn:hover {
            background: #e53e3e;
        }

        .loading {
            text-align: center;
            color: white;
            font-size: 18px;
            margin-top: 20px;
        }

        #formTitle {
            font-size: 20px;
            margin-bottom: 15px;
            color: #667eea;
            font-weight: bold;
        }

        #cancelBtn {
            width: 100%;
            background: #cbd5e0;
            color: #2d3748;
            margin-top: 10px;
            display: none;
        }

        #cancelBtn:hover {
            background: #a0aec0;
        }
    </style>
</head>

<body>
    <h1>üìÖ Event Management System</h1>
    
    <div id="inputDiv">
        <div id="formTitle">Add New Event</div>
        <input type="text" placeholder="Event name" id="name">
        <input type="email" placeholder="Email Address" id="email">
        <input type="text" placeholder="Company" id="company">
        <input type="text" placeholder="Location" id="location">
        <input type="text" placeholder="Description" id="description">
        <input type="date" placeholder="Date" id="date">
        <input type="text" placeholder="Host" id="host">
        <button id="submitBtn">Save Event</button>
        <button id="cancelBtn">Cancel Edit</button>
    </div>

    <div id="display">
        <div class="loading" id="loading">Loading events...</div>
        <div id="eventsContainer"></div>
    </div>

<script type="module">
    // Get DOM elements
    const nameInput = document.getElementById('name');
    const emailInput = document.getElementById('email');
    const companyInput = document.getElementById('company');
    const locationInput = document.getElementById('location');
    const descriptionInput = document.getElementById('description');
    const dateInput = document.getElementById('date');
    const hostInput = document.getElementById('host');
    const submitBtn = document.getElementById('submitBtn');
    const cancelBtn = document.getElementById('cancelBtn');
    const formTitle = document.getElementById('formTitle');
    const eventsContainer = document.getElementById('eventsContainer');
    const loading = document.getElementById('loading');

    // Import Firebase functions
    import { initializeApp } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-app.js";
    import { getDatabase, ref, set, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/12.6.0/firebase-database.js";

    // Firebase configuration
    const firebaseConfig = {
        apiKey: "AIzaSyCPsaTnEv7jA_kGv0M-4YqsYkbBDh1q7GU",
        authDomain: "event-management-system-2573b.firebaseapp.com",
        databaseURL: "https://event-management-system-2573b-default-rtdb.firebaseio.com",
        projectId: "event-management-system-2573b",
        storageBucket: "event-management-system-2573b.firebasestorage.app",
        messagingSenderId: "559563898888",
        appId: "1:559563898888:web:6f3fed6417b572b1ef11bd"
    };

    // Initialize Firebase
    const app = initializeApp(firebaseConfig);
    const db = getDatabase(app);

    // Track if we're editing
    let editingEventId = null;

    // Write or update event to database
    function saveEvent() {
        // Validation
        if (!nameInput.value || !emailInput.value || !dateInput.value) {
            alert('Please fill in at least Event Name, Email, and Date');
            return;
        }

        const eventData = {
            name: nameInput.value,
            email: emailInput.value,
            company: companyInput.value,
            location: locationInput.value,
            description: descriptionInput.value,
            date: dateInput.value,
            host: hostInput.value,
            timestamp: Date.now()
        };

        if (editingEventId) {
            // Update existing event
            update(ref(db, 'event-management-system/' + editingEventId), eventData)
                .then(() => {
                    alert('Event updated successfully!');
                    clearForm();
                })
                .catch((error) => {
                    alert('Error updating event: ' + error.message);
                });
        } else {
            // Create new event
            set(push(ref(db, 'event-management-system/')), eventData)
                .then(() => {
                    alert('Event saved successfully!');
                    clearForm();
                })
                .catch((error) => {
                    alert('Error saving event: ' + error.message);
                });
        }
    }

    // Clear form and reset to add mode
    function clearForm() {
        nameInput.value = "";
        emailInput.value = "";
        companyInput.value = "";
        locationInput.value = "";
        descriptionInput.value = "";
        dateInput.value = "";
        hostInput.value = "";
        editingEventId = null;
        formTitle.textContent = 'Add New Event';
        submitBtn.textContent = 'Save Event';
        cancelBtn.style.display = 'none';
    }

    // Read and display all events
    function readEvents() {
        const eventsRef = ref(db, "event-management-system/");
        
        onValue(eventsRef, (snapshot) => {
            const data = snapshot.val();
            loading.style.display = 'none';
            eventsContainer.innerHTML = '';

            if (data) {
                // Convert object to array and sort by timestamp
                const eventsArray = Object.entries(data).map(([id, event]) => ({
                    id,
                    ...event
                })).sort((a, b) => (b.timestamp || 0) - (a.timestamp || 0));

                // Display each event
                eventsArray.forEach(event => {
                    displayEvent(event);
                });
            } else {
                eventsContainer.innerHTML = '<p style="color: white; text-align: center;">No events found. Add your first event!</p>';
            }
        }, (error) => {
            loading.style.display = 'none';
            eventsContainer.innerHTML = '<p style="color: white; text-align: center;">Error loading events: ' + error.message + '</p>';
        });
    }

    // Display a single event card
    function displayEvent(event) {
        const card = document.createElement('div');
        card.className = 'event-card';
        card.innerHTML = `
            <h3>${event.name}</h3>
            <p><strong>üìß Email:</strong> ${event.email}</p>
            <p><strong>üè¢ Company:</strong> ${event.company || 'N/A'}</p>
            <p><strong>üìç Location:</strong> ${event.location || 'N/A'}</p>
            <p><strong>üìù Description:</strong> ${event.description || 'N/A'}</p>
            <p><strong>üìÖ Date:</strong> ${event.date}</p>
            <p><strong>üë§ Host:</strong> ${event.host || 'N/A'}</p>
            <div class="card-buttons">
                <button class="edit-btn" onclick="editEvent('${event.id}')">‚úèÔ∏è Edit</button>
                <button class="delete-btn" onclick="deleteEvent('${event.id}')">üóëÔ∏è Delete</button>
            </div>
        `;
        eventsContainer.appendChild(card);
    }

    // Edit event
    window.editEvent = function(eventId) {
        const eventRef = ref(db, 'event-management-system/' + eventId);
        
        onValue(eventRef, (snapshot) => {
            const event = snapshot.val();
            if (event) {
                nameInput.value = event.name || '';
                emailInput.value = event.email || '';
                companyInput.value = event.company || '';
                locationInput.value = event.location || '';
                descriptionInput.value = event.description || '';
                dateInput.value = event.date || '';
                hostInput.value = event.host || '';
                
                editingEventId = eventId;
                formTitle.textContent = 'Edit Event';
                submitBtn.textContent = 'Update Event';
                cancelBtn.style.display = 'block';
                
                // Scroll to form
                document.getElementById('inputDiv').scrollIntoView({ behavior: 'smooth' });
            }
        }, { onlyOnce: true });
    };

    // Delete event
    window.deleteEvent = function(eventId) {
        if (confirm('Are you sure you want to delete this event?')) {
            remove(ref(db, 'event-management-system/' + eventId))
                .then(() => {
                    alert('Event deleted successfully!');
                })
                .catch((error) => {
                    alert('Error deleting event: ' + error.message);
                });
        }
    };

    // Event listeners
    submitBtn.addEventListener('click', saveEvent);
    cancelBtn.addEventListener('click', clearForm);

    // Start reading events on page load
    readEvents();
</script>

</body>
</html>